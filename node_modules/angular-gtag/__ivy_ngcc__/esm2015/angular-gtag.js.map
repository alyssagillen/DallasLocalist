{"version":3,"file":"angular-gtag.js","sources":["angular-gtag/out/src/gtag.service.ts","angular-gtag/out/src/gtag-event.directive.ts","angular-gtag/out/src/gtag.module.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable, Inject } from '@angular/core';\r\nimport { GtagPageview, GtagEvent, GtagConfig } from './interfaces';\r\nimport { Router, NavigationEnd } from '@angular/router';\r\nimport { tap, filter } from 'rxjs/operators';\r\ndeclare var gtag: any;\r\n\r\n@Injectable()\r\nexport class Gtag {\r\n  private mergedConfig: GtagConfig;\r\n  constructor(@Inject('config') gaConfig: GtagConfig, private router: Router) {\r\n    this.mergedConfig = { trackPageviews: true, ...gaConfig };\r\n    if (this.mergedConfig.trackPageviews) {\r\n      router.events\r\n        .pipe(\r\n          filter(event => event instanceof NavigationEnd),\r\n          tap(event => {\r\n            this.pageview();\r\n          })\r\n        )\r\n        .subscribe();\r\n    }\r\n  }\r\n\r\n  event(action: string, params: GtagEvent = {}) {\r\n    // try/catch to avoid cross-platform issues\r\n    try {\r\n      gtag('event', action, params);\r\n      this.debug('event', this.mergedConfig.trackingId, action, params);\r\n    } catch (err) {\r\n      console.error('Google Analytics event error', err);\r\n    }\r\n  }\r\n\r\n  pageview(params?: GtagPageview) {\r\n    try {\r\n      const defaults = {\r\n        page_path: this.router.url,\r\n        page_title: 'Angular App',\r\n        page_location: window.location.href\r\n      };\r\n\r\n      params = { ...defaults, ...params };\r\n      gtag('config', this.mergedConfig.trackingId, params);\r\n      this.debug('pageview', this.mergedConfig.trackingId, params);\r\n    } catch (err) {\r\n      console.error('Google Analytics pageview error', err);\r\n    }\r\n  }\r\n\r\n  config(params: any) {\r\n    try {\r\n      gtag('config', this.mergedConfig.trackingId, (params = {}));\r\n    } catch (err) {\r\n      console.error('Google Analytics config error', err);\r\n    }\r\n  }\r\n\r\n  set(params: any) {\r\n    try {\r\n      gtag('set', (params = {}));\r\n    } catch (err) {\r\n      console.error('Google Analytics set error', err);\r\n    }\r\n  }\r\n\r\n  private debug(...msg) {\r\n    if (this.mergedConfig.debug) {\r\n      console.log('angular-gtag:', ...msg);\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Directive,\r\n  HostListener,\r\n  Renderer2,\r\n  Input,\r\n  AfterViewInit,\r\n  ElementRef\r\n} from '@angular/core';\r\nimport { Gtag } from './gtag.service';\r\n\r\n@Directive({\r\n  selector: '[gtagEvent]'\r\n})\r\nexport class GtagEventDirective implements AfterViewInit {\r\n  @Input() trackOn: string;\r\n  @Input() action: string;\r\n  @Input() category: string;\r\n  @Input() params: any;\r\n\r\n  constructor(\r\n    private gtag: Gtag,\r\n    private renderer: Renderer2,\r\n    private el: ElementRef\r\n  ) {}\r\n\r\n  ngAfterViewInit() {\r\n    try {\r\n      this.renderer.listen(this.el.nativeElement, this.trackOn, () => {\r\n        this.gtag.event(this.action || this.trackOn, {\r\n          event_category: this.category,\r\n          ...this.params\r\n        });\r\n      });\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { Gtag } from './gtag.service';\r\nimport { GtagEventDirective } from './gtag-event.directive';\r\n\r\nimport { RouterModule } from '@angular/router';\r\nimport { GtagConfig } from './interfaces';\r\n\r\n@NgModule({\r\n  declarations: [GtagEventDirective],\r\n  exports: [GtagEventDirective]\r\n})\r\nexport class GtagModule {\r\n  public static forRoot(config: GtagConfig): ModuleWithProviders {\r\n    return {\r\n      ngModule: GtagModule,\r\n      providers: [Gtag, { provide: 'config', useValue: config }]\r\n    };\r\n  }\r\n}\r\n"]}